<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Five Nights with The Boys v3 (Hardcore)</title>
    <style>
        :root {
            --metal-dark: #1a1a1a;
            --cam-btn-bg: #444;
            --danger-green: #0f0;
            --danger-yellow: #ff0;
            --danger-red: #f00;
        }

        body {
            margin: 0; padding: 0;
            background-color: #000; color: #fff;
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden; user-select: none;
            height: 100vh; width: 100vw;
        }

        /* --- AMBIENTE GERAL --- */
        #game-screen {
            width: 100%; height: 100%; position: relative;
            background: radial-gradient(circle at 50% 50%, #222 10%, #000 90%);
            display: none;
        }
        
        .static-overlay {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABZJREFUeNpi2r9//38gYGAEESAAEGAAasgJOgzOKCoAAAAASUVORK5CYII=');
            opacity: 0.08; pointer-events: none; z-index: 90;
        }

        /* --- UI PRINCIPAL --- */
        .ui-text {
            position: absolute; z-index: 95; font-weight: bold; text-shadow: 2px 2px 0 #000; pointer-events: none;
        }
        #time-display { top: 20px; right: 20px; font-size: 32px; }
        #power-display { bottom: 20px; left: 20px; font-size: 20px; }
        
        /* MEDIDOR DE PERIGO */
        #danger-meter {
            top: 20px; left: 50%; transform: translateX(-50%);
            font-size: 24px; border: 2px solid #555; padding: 5px 15px;
            background: rgba(0,0,0,0.8); transition: color 0.5s;
        }

        /* --- PORTAS E BOTÕES --- */
        .door-visual {
            position: absolute; top: 0; bottom: 0; width: 150px;
            background: repeating-linear-gradient(45deg, #222, #222 10px, #111 10px, #111 20px);
            border: 2px solid #333; transition: transform 0.2s linear;
            z-index: 10;
        }
        #door-left { left: 0; transform: translateY(-100%); border-right: 5px solid yellow; }
        #door-right { right: 0; transform: translateY(-100%); border-left: 5px solid yellow; }
        .door-visual.closed { transform: translateY(0) !important; }

        .control-panel {
            position: absolute; top: 50%; transform: translateY(-50%);
            display: flex; flex-direction: column; gap: 15px; z-index: 80;
        }
        #panel-left { left: 160px; }
        #panel-right { right: 160px; }

        .game-btn {
            width: 60px; height: 60px; background: #500; border: 3px solid #700;
            border-radius: 5px; color: white; font-weight: bold; cursor: pointer;
            box-shadow: 0 0 10px #000;
        }
        .game-btn.active { background: #0a0; border-color: #0f0; box-shadow: 0 0 20px #0f0; }

        /* --- CÂMERA SISTEMA --- */
        #cam-trigger {
            position: absolute; bottom: 20px; right: 150px; width: 300px; padding: 10px;
            background: #333; border: 2px solid #fff; text-align: center; cursor: pointer;
            z-index: 99; opacity: 0.7; font-size: 20px;
        }
        #cam-trigger:hover { opacity: 1; }

        #camera-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 96; display: none;
        }

        /* Visualização da Câmera (Onde a foto aparece) */
        #cam-view-port {
            width: 80%; height: 80%; margin: 20px auto;
            border: 2px solid #555; position: relative; overflow: hidden;
            background: #111;
        }
        
        .cam-scanline {
            position: absolute; width: 100%; height: 10px; background: rgba(255,255,255,0.1);
            animation: scan 3s linear infinite; pointer-events: none;
        }
        @keyframes scan { 0% {top: -10%} 100% {top: 110%} }

        #cam-image-container {
            width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;
        }
        #cam-monster-img {
            max-width: 90%; max-height: 90%; display: none; /* Só aparece se monstro estiver lá */
            filter: grayscale(100%) contrast(1.5) brightness(0.6);
        }
        #no-signal-text {
            position: absolute; top:50%; left:50%; transform:translate(-50%,-50%);
            font-size: 40px; color: #333; display: block;
        }

        /* Mapa das Câmeras */
        #cam-map {
            position: absolute; bottom: 20px; right: 20px;
            width: 200px; height: 150px; border: 1px solid #555;
            background: rgba(0,0,0,0.8); padding: 10px;
            display: grid; grid-template-columns: 1fr 1fr; gap: 5px;
        }
        .cam-select-btn {
            background: #222; color: #fff; border: 1px solid #555; cursor: pointer; font-size: 12px;
        }
        .cam-select-btn.selected { background: #0a0; color: #000; font-weight: bold; }

        /* --- TELAS FINAIS --- */
        #jumpscare-overlay, #start-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 100; display: flex;
            justify-content: center; align-items: center; flex-direction: column;
        }
        #jumpscare-overlay { display: none; }
        #jumpscare-full-img { width: 100%; height: 100%; object-fit: cover; }
        
        #start-screen {
            background-image: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('scare1.png'); /* Usa uma foto como fundo */
            background-size: cover;
        }
    </style>
</head>
<body>
    <div class="static-overlay"></div>

    <div id="start-screen">
        <h1 style="font-size: 50px; color: #d00; text-shadow: 0 0 10px #f00;">IMPOSSIBLE MODE</h1>
        <p>Chance de Jumpscare Ativada.</p>
        <button onclick="startGame()" style="padding: 20px; font-size: 24px; cursor: pointer; background: #a00; border: none; color: white;">COMEÇAR NOITE</button>
    </div>

    <div id="game-screen">
        <div id="danger-meter" class="ui-text">RISCO: 0%</div>
        <div id="time-display" class="ui-text">12 AM</div>
        <div id="power-display" class="ui-text">Power: 100%</div>

        <div id="door-left" class="door-visual"></div>
        <div id="door-right" class="door-visual"></div>

        <div id="panel-left" class="control-panel">
            <button id="btn-left" class="game-btn" onclick="toggleDoor('left')">DOOR</button>
            <button class="game-btn" style="background:#444;">LGT</button>
        </div>
        <div id="panel-right" class="control-panel">
            <button id="btn-right" class="game-btn" onclick="toggleDoor('right')">DOOR</button>
            <button class="game-btn" style="background:#444;">LGT</button>
        </div>

        <div id="cam-trigger" onclick="toggleCamera()">ABRIR MONITOR</div>

        <div id="camera-screen">
            <div id="cam-view-port">
                <div class="cam-scanline"></div>
                <div style="position:absolute; top:10px; left:10px; color:white;">REC ●</div>
                <div id="current-cam-name" style="position:absolute; top:10px; right:10px; color:white;">CAM 1A</div>
                
                <div id="cam-image-container">
                    <span id="no-signal-text">NO SIGNAL</span>
                    <img id="cam-monster-img" src="" alt="monster">
                </div>
            </div>

            <div id="cam-map">
                <button class="cam-select-btn selected" onclick="switchCam('cam1a')">CAM 1A (Palco)</button>
                <button class="cam-select-btn" onclick="switchCam('cam1b')">CAM 1B (Salão)</button>
                <button class="cam-select-btn" onclick="switchCam('cam2a')">CAM 2A (Corredor Esq)</button>
                <button class="cam-select-btn" onclick="switchCam('cam2b')">CAM 2B (Corredor Dir)</button>
                <button class="cam-select-btn" onclick="switchCam('cam3')">CAM 3 (Porta ESQ)</button>
                <button class="cam-select-btn" onclick="switchCam('cam4')">CAM 4 (Porta DIR)</button>
            </div>
        </div>
    </div>

    <div id="jumpscare-overlay">
        <img id="jumpscare-full-img" src="">
    </div>

    <audio id="audio-scream" src="scream.mp3"></audio>
    <audio id="audio-door" src="door.mp3"></audio>

    <script>
        // --- CONFIGURAÇÃO ---
        const gameState = {
            active: false,
            hour: 0,
            power: 100,
            danger: 0, // 0 a 100%
            cameraOpen: false,
            currentCam: 'cam1a',
            leftDoor: false,
            rightDoor: false,
            monsterLoc: 'cam1a', // Começa no palco
            monsterImgIndex: 1 // Qual foto usar
        };

        // Mapeamento de Câmeras
        const cams = ['cam1a', 'cam1b', 'cam2a', 'cam2b', 'cam3', 'cam4'];
        
        // Timer references
        let timers = {};

        function startGame() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('game-screen').style.display = 'block';
            gameState.active = true;
            
            timers.clock = setInterval(gameClock, 15000); // 15s por hora
            timers.ai = setInterval(monsterAI, 4000); // Monstro move a cada 4s
            timers.power = setInterval(powerDrain, 500);
            timers.danger = setInterval(dangerMechanic, 1000); // Calcula risco a cada 1s
        }

        // --- SISTEMA DE RISCO (DANGER) ---
        function dangerMechanic() {
            if (!gameState.active) return;
            
            // O risco aumenta naturalmente com o tempo
            let increase = 1;
            
            // Se o monstro estiver nas portas, risco sobe MUITO
            if (gameState.monsterLoc === 'cam3' || gameState.monsterLoc === 'cam4') {
                increase = 5;
            }

            // Portas fechadas acalmam um pouco o risco (falsa sensação de segurança)
            if (gameState.leftDoor || gameState.rightDoor) {
                increase -= 2;
            }

            gameState.danger += increase;
            
            // Limites
            if (gameState.danger < 0) gameState.danger = 0;
            if (gameState.danger > 100) gameState.danger = 100;

            updateDangerUI();
        }

        function updateDangerUI() {
            const el = document.getElementById('danger-meter');
            el.innerText = `RISCO: ${gameState.danger}%`;
            
            if (gameState.danger <= 30) {
                el.style.color = 'var(--danger-green)';
                el.style.borderColor = 'var(--danger-green)';
            } else if (gameState.danger <= 70) {
                el.style.color = 'var(--danger-yellow)';
                el.style.borderColor = 'var(--danger-yellow)';
            } else {
                el.style.color = 'var(--danger-red)';
                el.style.borderColor = 'var(--danger-red)';
            }
        }

        function checkRiskAction() {
            // Toda vez que o jogador faz algo, checa se morre pelo risco alto
            if (gameState.danger > 80) {
                // 30% de chance de morrer a qualquer clique se o risco estiver alto
                if (Math.random() < 0.3) {
                    forceJumpscare();
                }
            }
        }

        // --- PORTAS ---
        function toggleDoor(side) {
            checkRiskAction();
            if (gameState.power <= 0) return;

            let audio = document.getElementById('audio-door');
            audio.currentTime = 0;
            audio.play().catch(e => {});

            if (side === 'left') {
                gameState.leftDoor = !gameState.leftDoor;
                document.getElementById('door-left').classList.toggle('closed', gameState.leftDoor);
                document.getElementById('btn-left').classList.toggle('active', gameState.leftDoor);
            } else {
                gameState.rightDoor = !gameState.rightDoor;
                document.getElementById('door-right').classList.toggle('closed', gameState.rightDoor);
                document.getElementById('btn-right').classList.toggle('active', gameState.rightDoor);
            }
        }

        // --- CÂMERAS ---
        function toggleCamera() {
            checkRiskAction();
            if (gameState.power <= 0) return;
            
            gameState.cameraOpen = !gameState.cameraOpen;
            document.getElementById('camera-screen').style.display = gameState.cameraOpen ? 'block' : 'none';
            
            if (gameState.cameraOpen) {
                updateCamView();
            }
        }

        function switchCam(camName) {
            checkRiskAction();
            gameState.currentCam = camName;
            
            // Atualizar botões UI
            document.querySelectorAll('.cam-select-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            
            document.getElementById('current-cam-name').innerText = camName.toUpperCase();
            updateCamView();
        }

        function updateCamView() {
            const img = document.getElementById('cam-monster-img');
            const txt = document.getElementById('no-signal-text');
            
            // Lógica: Se o monstro está onde a câmera está
            if (gameState.monsterLoc === gameState.currentCam) {
                // Seleciona uma foto baseada no index atual (para variar as fotos)
                img.src = `scare${gameState.monsterImgIndex}.png`;
                img.style.display = 'block';
                txt.style.display = 'none';

                // SE ESTIVER NA PORTA (CAM3 ou CAM4) e o jogador olhou
                if (gameState.monsterLoc === 'cam3' || gameState.monsterLoc === 'cam4') {
                    // Espera 0.3s e mata
                    setTimeout(() => {
                        if (gameState.cameraOpen && gameState.active) {
                            forceJumpscare();
                        }
                    }, 300);
                }

            } else {
                img.style.display = 'none';
                txt.style.display = 'block';
            }
        }

        // --- IA DO MONSTRO ---
        function monsterAI() {
            if (!gameState.active) return;

            // Chance de mover baseada no perigo atual
            // Se perigo alto, move mais rápido
            let moveChance = 0.4 + (gameState.danger / 200); 
            
            if (Math.random() < moveChance) {
                // Rota simples: 1a -> 1b -> 2a/2b -> 3/4 -> ATAQUE
                let oldLoc = gameState.monsterLoc;
                
                if (oldLoc === 'cam1a') gameState.monsterLoc = 'cam1b';
                else if (oldLoc === 'cam1b') gameState.monsterLoc = Math.random() > 0.5 ? 'cam2a' : 'cam2b';
                else if (oldLoc === 'cam2a') gameState.monsterLoc = 'cam3'; // Porta Esq
                else if (oldLoc === 'cam2b') gameState.monsterLoc = 'cam4'; // Porta Dir
                else if (oldLoc === 'cam3') {
                    // Na porta esquerda
                    if (gameState.leftDoor) {
                        gameState.monsterLoc = 'cam1a'; // Bloqueado, volta
                        gameState.danger -= 20; // Recompensa
                    } else {
                        // Se não estiver olhando a camera, ele entra
                        if (!gameState.cameraOpen) forceJumpscare();
                    }
                }
                else if (oldLoc === 'cam4') {
                    // Na porta direita
                    if (gameState.rightDoor) {
                        gameState.monsterLoc = 'cam1a'; // Bloqueado
                        gameState.danger -= 20;
                    } else {
                        if (!gameState.cameraOpen) forceJumpscare();
                    }
                }

                // Troca a foto aleatoriamente a cada movimento
                gameState.monsterImgIndex = Math.floor(Math.random() * 5) + 1;
                
                // Se a camera estiver aberta, atualiza a visão (pode aparecer ou sumir)
                if (gameState.cameraOpen) updateCamView();
            }
        }

        // --- SISTEMAS GERAIS ---
        function gameClock() {
            if (!gameState.active) return;
            gameState.hour++;
            let h = gameState.hour === 0 ? 12 : gameState.hour;
            document.getElementById('time-display').innerText = h + " AM";
            if (gameState.hour === 6) winGame();
        }

        function powerDrain() {
            if (!gameState.active) return;
            let drain = 0.1;
            if (gameState.leftDoor) drain += 0.3;
            if (gameState.rightDoor) drain += 0.3;
            if (gameState.cameraOpen) drain += 0.2;
            
            gameState.power -= drain;
            document.getElementById('power-display').innerText = `Power: ${Math.floor(gameState.power)}%`;
            
            if (gameState.power <= 0) {
                gameState.active = false;
                document.getElementById('game-screen').style.opacity = 0.1;
                setTimeout(forceJumpscare, 4000); // Morte no escuro
            }
        }

        function forceJumpscare() {
            if (!gameState.active) return; // Evita duplo jumpscare
            gameState.active = false;
            
            document.getElementById('game-screen').style.display = 'none';
            document.getElementById('jumpscare-overlay').style.display = 'flex';
            
            // Pega foto aleatória pro susto final
            let r = Math.floor(Math.random() * 5) + 1;
            document.getElementById('jumpscare-full-img').src = `scare${r}.png`;
            
            // Animação CSS manual via JS para tremer muito
            let img = document.getElementById('jumpscare-full-img');
            img.style.animation = "shake 0.1s infinite";
            
            document.getElementById('audio-scream').play().catch(()=>{});

            setTimeout(() => {
                alert("GAME OVER\nO Risco estava em: " + Math.floor(gameState.danger) + "%");
                location.reload();
            }, 2500);
        }

        function winGame() {
            gameState.active = false;
            alert("6:00 AM - VOCÊ SOBREVIVEU A NOITE IMPOSSÍVEL!");
            location.reload();
        }
    </script>
    <style>
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
    </style>
</body>
</html>
